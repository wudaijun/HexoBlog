---
title: Linux进程，进程组，会话
layout: post
categories: os
tags:
- os
- linux

---
### 进程组/会话

简要概念：

- 进程组：N(N>=1)个进程的集合，通常在同一作业中关联起来(通过管道)。进程组的ID(PGID)即为进程组组长的PID。进程必定且只能属于一个进程组，只有进程组中一个进程存在，进程组就存在，与组长进程终止与否无关。进程组的概念提出主要是为了进程管理与信号分发
- 会话：N(N>=1)个进程组的集合，创建会话的进程叫会话首进程。会话ID即为会话首进程PID
- 控制终端：如果会话有控制终端，建立与控制终端连接的会话首进程叫控制进程(通常就是Shell进程)，当前与终端交互的进程组为前台进程组，其余进程组成为后台进程组
- 无论合适输入终端的退出键，都会将退出信号发送到前台进程组的所有进程
- 如果控制终端断开连接，则将挂掉信号(SIGHUP)发送至控制进程(会话首进程)，SIGHUP信号默认将导致控制进程终止

<!--more-->

例如，打开Bash，输入：
          proc1 | proc2 &          proc3 | proc4 | proc5
       
进程关系如下图所示：
 
![](/assets/image/linux/linux-session-process.png  "进程组，会话和控制终端")



### 作业管理：

- & 将作业放入后台执行，如果没有进行重定向，数据流仍然会输出到前台
- Ctrl-C 强制中断前台当前作业执行
- Ctrl-Z 将作业挂到后台
- jobs -l 查看所有作业，作业ID和其PID
- fg %作业ID 将后台作业拿到前台来处理
- bg %作业ID 将后台作业由挂起变为执行
- kill -signal %作业ID
	- -2: 相当于 Ctrl-C
	- -9 强制删除一个作业
	- -15 以正常程序方式终止一项作业

作业管理的后台不是系统后台，因此，上述的任务管理依旧与终端有关，当远程连接的终端断开连接时，SIGHUP信号默认将导致改会话上所有的任务都会被中断。

### 脱机管理：

- nohup: nohup CMD & 将任务放在后台执行，并忽略SIGHUP挂掉信号，但是在人机交互上比较麻烦
- screen: 一个可以在多个进程之间多路复用一个物理终端的窗口管理器，在远端服务器上运行screen，开启一个新会话并执行任务，在终端断开后，任务继续执行，下次登录再attach上screen会话即可，Linux发行版自带
- tmux: 功能类似于screen，但在分屏切换，配置方面更强大，完全可作为本地终端使用



